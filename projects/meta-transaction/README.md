# Meta-Transaction Project

μ΄ ν”„λ΅μ νΈλ” Ethereumμ—μ„ λ©”νƒ€νΈλμ­μ…(Meta-Transaction)μ„ κµ¬ν„ν• μμ μ…λ‹λ‹¤. μ‚¬μ©μκ°€ κ°€μ¤λΉ„λ¥Ό μ§€λ¶ν•μ§€ μ•κ³ λ„ μ¤λ§νΈ μ»¨νΈλ™νΈμ™€ μƒνΈμ‘μ©ν•  μ μλ„λ΅ ν•©λ‹λ‹¤.

## π€ μ£Όμ” κΈ°λ¥

### **1. λ©”νƒ€νΈλμ­μ… μ‹¤ν–‰**
- μ‚¬μ©μκ°€ μ„λ…ν• νΈλμ­μ…μ„ λ¦΄λ μ΄μ–΄κ°€ λ€μ‹  μ‹¤ν–‰
- κ°€μ¤λΉ„λ” λ¦΄λ μ΄μ–΄κ°€ λ¶€λ‹΄
- EIP-2771 ν‘μ¤€ μ¤€μ

### **2. λ°°μΉ μ²λ¦¬**
- μ—¬λ¬ λ©”νƒ€νΈλμ­μ…μ„ ν• λ²μ— μ‹¤ν–‰
- κ°€μ¤ ν¨μ¨μ„± ν–¥μƒ
- λ¶€λ¶„ μ‹¤ν¨ ν—μ© (μΌλ¶€ μ„±κ³µ, μΌλ¶€ μ‹¤ν¨)

### **3. κ³ κΈ‰ μ—λ¬ μ²λ¦¬**
- μ›λ³Έ μ»¨νΈλ™νΈμ revert reasonμ„ κ·Έλ€λ΅ μ „ν
- μƒμ„Έν• μ—λ¬ λ΅κΉ…
- λ””λ²„κΉ… μΉν™”μ μΈ κµ¬μ΅°

## π“ ν”„λ΅μ νΈ κµ¬μ΅°

```
projects/meta-transaction/
β”β”€β”€ contracts/
β”‚   β”β”€β”€ MyForwarder.sol          # λ©”μΈ ν¬μ›λ” μ»¨νΈλ™νΈ
β”‚   β”β”€β”€ MetaTxReceiver.sol       # λ©”νƒ€νΈλμ­μ… μμ‹ μ
β”‚   β””β”€β”€ Refunder.sol             # ν™λ¶ μ²λ¦¬ μ»¨νΈλ™νΈ
β”β”€β”€ test/
β”‚   β””β”€β”€ MyForwarder.test.js      # ν¬μ›λ” ν…μ¤νΈ
β”β”€β”€ scripts/
β”‚   β”β”€β”€ deploy.js                 # μ»¨νΈλ™νΈ λ°°ν¬
β”‚   β”β”€β”€ deployContracts.js        # μ „μ²΄ λ°°ν¬ μ¤ν¬λ¦½νΈ
β”‚   β””β”€β”€ signAndRelay.js          # μ„λ… λ° λ¦΄λ μ΄
β””β”€β”€ README.md                     # μ΄ νμΌ
```

## π—οΈ μ•„ν‚¤ν…μ²

### **μ»¨νΈλ™νΈ κ΄€κ³„**
```
User (Signer) β†’ MyForwarder β†’ MetaTxReceiver
     β†“              β†“              β†“
   μ„λ… μƒμ„±    μ”μ²­ κ²€μ¦ λ° μ‹¤ν–‰   μ‹¤μ  λ΅μ§ μ‹¤ν–‰
```

### **ν•µμ‹¬ μ»΄ν¬λ„νΈ**
1. **MyForwarder**: EIP-2771 ν‘μ¤€μ„ ν™•μ¥ν• ν¬μ›λ”
2. **MetaTxReceiver**: λ©”νƒ€νΈλμ­μ…μ„ λ°›μ•„ μ²λ¦¬ν•λ” μ»¨νΈλ™νΈ
3. **Refunder**: κ°€μ¤λΉ„ ν™λ¶μ„ μ²λ¦¬ν•λ” μ»¨νΈλ™νΈ

## π”§ μ„¤μΉ λ° μ‹¤ν–‰

### **μμ΅΄μ„± μ„¤μΉ**
```bash
pnpm install
```

### **ν…μ¤νΈ μ‹¤ν–‰**
```bash
pnpm --filter meta-transaction run test
```

### **μ»¨νΈλ™νΈ λ°°ν¬**
```bash
pnpm --filter meta-transaction run deploy
```

## π“ μ‚¬μ©λ²•

### **1. λ©”νƒ€νΈλμ­μ… μƒμ„±**
```javascript
const request = {
    from: userAddress,
    to: contractAddress,
    value: 0,
    gas: 300000,
    deadline: Math.floor(Date.now() / 1000) + 3600,
    data: encodedFunctionData,
    signature: "0x"
};
```

### **2. μ„λ… μƒμ„±**
```javascript
const signature = await signer.signTypedData(domain, types, request);
const signedRequest = { ...request, signature };
```

### **3. λ¦΄λ μ΄ μ‹¤ν–‰**
```javascript
const tx = await forwarder.connect(relayer).execute(signedRequest);
```

## π§ ν…μ¤νΈ μΌ€μ΄μ¤

### **λ‹¨μΌ μ‹¤ν–‰ ν…μ¤νΈ**
- β… μ •μƒμ μΈ λ©”νƒ€νΈλμ­μ… μ‹¤ν–‰
- β… μλ»λ μ„λ… μ²λ¦¬
- β… λ§λ£λ μ”μ²­ μ²λ¦¬
- β… νƒ€κ² μ»¨νΈλ™νΈ revert μ²λ¦¬

### **λ°°μΉ μ‹¤ν–‰ ν…μ¤νΈ**
- β… μ—¬λ¬ μ”μ²­ λ™μ‹ μ²λ¦¬
- β… λ¶€λ¶„ μ‹¤ν¨ μ‹λ‚λ¦¬μ¤
- β… κ°€μ¤λΉ„ λ¶μΌμΉ μ²λ¦¬

## π”’ λ³΄μ• κΈ°λ¥

### **1. μ„λ… κ²€μ¦**
- EIP-712 ν‘μ¤€ μ¤€μ
- Nonce κΈ°λ° replay attack λ°©μ§€
- λ§λ£ μ‹κ°„ κ²€μ¦

### **2. κ¶ν• κ΄€λ¦¬**
- μ„λ…μ μ£Όμ† κ²€μ¦
- κ°€μ¤ ν•κ³„ μ„¤μ •
- κ°€μ¤λΉ„ ν™λ¶ λ©”μ»¤λ‹μ¦

### **3. μ—λ¬ μ²λ¦¬**
- μ›λ³Έ revert reason λ³΄μ΅΄
- μƒμ„Έν• μ—λ¬ λ΅κΉ…
- μ•μ „ν• μ‹¤ν¨ μ²λ¦¬

## π μ£Όμ” νΉμ§•

### **1. EIP-2771 ν‘μ¤€ μ¤€μ**
- OpenZeppelinμ ERC2771Forwarder μƒμ†
- ν‘μ¤€ μΈν„°νμ΄μ¤ κµ¬ν„
- νΈν™μ„± λ³΄μ¥

### **2. κ³ κΈ‰ μ—λ¬ μ²λ¦¬**
- μ›λ³Έ μ»¨νΈλ™νΈ μ—λ¬ μ „ν
- μƒμ„Έν• μ—λ¬ μ •λ³΄ μ κ³µ
- λ””λ²„κΉ… μΉν™”μ  κµ¬μ΅°

### **3. κ°€μ¤ μµμ ν™”**
- λ°°μΉ μ²λ¦¬λ΅ κ°€μ¤ ν¨μ¨μ„± ν–¥μƒ
- λ¶ν•„μ”ν• μƒνƒ λ³€κ²½ μµμ†ν™”
- ν¨μ¨μ μΈ λ©”λ¨λ¦¬ μ‚¬μ©

## π¨ μ£Όμμ‚¬ν•­

### **1. Nonce κ΄€λ¦¬**
- κ° μ”μ²­λ§λ‹¤ κ³ μ ν• nonce μ‚¬μ©
- μμ°¨μ  nonce μ¦κ°€ ν•„μ
- μ„λ… κ²€μ¦ μ‹¤ν¨ λ°©μ§€

### **2. κ°€μ¤λΉ„ κ³„μ‚°**
- λ¦΄λ μ΄μ–΄μ κ°€μ¤λΉ„ λ¶€λ‹΄
- μ μ ν• κ°€μ¤ ν•κ³„ μ„¤μ •
- ν™λ¶ λ©”μ»¤λ‹μ¦ κ³ λ ¤

### **3. λ³΄μ• κ³ λ ¤μ‚¬ν•­**
- μ„λ… κ²€μ¦μ μ¤‘μ”μ„±
- λ§λ£ μ‹κ°„ μ„¤μ •
- κ¶ν• κ΄€λ¦¬

## π¤ κΈ°μ—¬ν•κΈ°

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit your changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

## π“„ λΌμ΄μ„ μ¤

μ΄ ν”„λ΅μ νΈλ” MIT λΌμ΄μ„ μ¤ ν•μ— λ°°ν¬λ©λ‹λ‹¤. μμ„Έν• λ‚΄μ©μ€ [LICENSE](LICENSE) νμΌμ„ μ°Έμ΅°ν•μ„Έμ”.

## π“ λ¬Έμ

ν”„λ΅μ νΈμ— λ€ν• μ§λ¬Έμ΄λ‚ μ μ•μ‚¬ν•­μ΄ μμΌμ‹λ©΄ μ΄μλ¥Ό μƒμ„±ν•΄ μ£Όμ„Έμ”.

---

**Happy Meta-Transactioning! π€**
